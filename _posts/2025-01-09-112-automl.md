---
title: 1차시 12(빅데이터 분석):AutoML
layout: single
classes: wide
categories:
  - Casino Analysis
toc: true # 이 포스트에서 목차를 활성화
toc_sticky: true # 목차를 고정할지 여부 (선택 사항)
---

## 1.**AutoML 소개**
*   AutoML(Automated Machine Learning, 자동화된 머신러닝)은 머신러닝 모델 개발 과정을 자동화하는 기술입니다. 즉, 데이터 전처리, 모델 선택, 하이퍼파라미터 튜닝 등 머신러닝 모델을 구축하는 데 필요한 복잡하고 반복적인 작업을 자동화하여 사용자가 보다 쉽고 효율적으로 머신러닝 모델을 개발하고 활용할 수 있도록 돕습니다.

### 1.1 **AutoML의 주요 목표**
- **머신러닝의 접근성 향상:** 머신러닝 전문가가 아니더라도 쉽게 머신러닝 모델을 구축하고 활용
- **개발 효율성 향상:** 머신러닝 모델 개발에 소요되는 시간과 노력을 줄여 개발자가 다른 중요한 작업에 집중
- **모델 성능 향상:** 다양한 알고리즘과 하이퍼파라미터를 자동으로 탐색하여 최적의 모델을 찾아냄.

### 1.2 **AutoML의 주요 기능**
- **데이터 전처리 자동화:** 결측치 처리, 이상치 탐지, 데이터 변환 등 데이터 전처리 과정을 자동화합니다.
- **모델 선택 자동화:** 다양한 머신러닝 알고리즘을 자동으로 평가하고 최적의 모델을 선택합니다.
- **하이퍼파라미터 튜닝 자동화:** 모델의 성능을 최적화하기 위해 하이퍼파라미터를 자동으로 조정합니다.
- **모델 평가 및 설명:** 모델의 성능을 평가하고 결과를 시각화하여 사용자가 모델을 쉽게 이해할 수 있도록 합니다.

### 1.3 **AutoML의 활용 분야**
- **이미지 인식:** 이미지 분류, 객체 탐지 등 이미지 인식 관련 작업에 활용됩니다.
- **자연어 처리:** 텍스트 분류, 감성 분석, 기계 번역 등 자연어 처리 관련 작업에 활용됩니다.
- **예측 분석:** 판매량 예측, 고객 이탈 예측, 위험 예측 등 예측 분석 관련 작업에 활용됩니다.
- **추천 시스템:** 사용자 맞춤형 추천 시스템 구축에 활용됩니다.

### 1.4 **AutoML의 장점**
- **시간 및 비용 절감:** 머신러닝 모델 개발에 소요되는 시간과 비용을 절감할 수 있습니다.
- **높은 성능:** 다양한 알고리즘과 하이퍼파라미터를 자동으로 탐색하여 높은 성능의 모델을 얻을 수 있습니다.
- **접근성 향상:** 머신러닝 전문가가 아니더라도 쉽게 머신러닝 모델을 개발하고 활용할 수 있습니다.

### 1.5 **AutoML의 단점**
- **유연성 부족:** 특정 요구사항에 맞춰 모델을 세밀하게 조정하기 어려울 수 있습니다.
- **설명력 부족:** 모델의 작동 방식을 완벽하게 이해하기 어려울 수 있습니다.
- **데이터 의존성:** 양질의 데이터가 충분하지 않으면 좋은 성능을 얻기 어렵습니다.

### 1.6 **주요 AutoML 라이브러리 및 프레임워크**
- **Google AutoML**  
   - Google Cloud Platform에서 제공하는 AutoML은 특히 사용 편의성과 강력한 클라우드 기반 지원으로 인기가 많습니다. 이미지, 텍스트, 테이블 데이터 등 다양한 데이터 유형에 대해 모델을 자동으로 설계하고 훈련시킬 수 있습니다. 특히 비전문가도 쉽게 접근할 수 있어 많이 사용됩니다.

- **H2O.ai**  
   - **H2O AutoML**은 오픈소스이며, 분류, 회귀 등 다양한 머신러닝 작업을 자동화합니다. 사용하기 쉬운 인터페이스와 함께 대규모 데이터셋에서도 효율적으로 동작하며, Python과 R을 지원해 데이터 과학자들 사이에서 인기 있습니다.

- **Auto-sklearn**  
   - Scikit-learn을 기반으로 한 오픈소스 AutoML 라이브러리로, 파이프라인 최적화와 하이퍼파라미터 튜닝을 자동화합니다. 비교적 가볍고 커스터마이징이 쉬워 연구나 소규모 프로젝트에서 많이 사용됩니다.

- **TPOT (Tree-based Pipeline Optimization Tool)**  
   - 유전 알고리즘을 활용해 머신러닝 파이프라인을 최적화하는 오픈소스 도구입니다. Scikit-learn과 호환되며, 파이썬 사용자들 사이에서 인기가 많습니다.

- **Microsoft Azure AutoML**  
   - Azure Machine Learning 플랫폼 내에서 제공되는 AutoML 기능으로, 클라우드 기반의 강력한 인프라와 함께 다양한 데이터 유형을 지원합니다. 기업 환경에서 많이 활용됩니다.

## 2. H2O AutoML 실습 기본 코드


### 2.1 샘플 코드 
- **구글 코랩에서 실행**

```python
# 매우 간단한 버전
import h2o
from h2o.automl import H2OAutoML

h2o.init()

# 1. 데이터 로드
df = h2o.import_file("https://h2o-public-test-data.s3.amazonaws.com/smalldata/wine/winequality-redwhite-no-BOM.csv")
train, test = df.split_frame([0.8])

# 2. AutoML 실행
aml = H2OAutoML(max_models=5, max_runtime_secs=120)  
aml.train(y="quality", training_frame=train)

# 3.결과 확인
print(aml.leaderboard)
predictions = aml.leader.predict(test)
print(predictions.head())

# 4.모델 저장
model_path = "/content/my_best_model"
saved_model_path = h2o.save_model(aml.leader, path=model_path, force=True)
print(f"   모델 저장 완료: {saved_model_path}")

# 5. 신규 데이터 생성
new_data_pandas = pd.DataFrame({
    'fixed acidity': 7.4,
    'volatile acidity': 0.70,
    'citric acid': 0.00,
    'residual sugar': 1.9,
    'chlorides': 0.076,
    'free sulfur dioxide': 11.0,
    'total sulfur dioxide': 34.0,
    'density': 0.9978,
    'pH': 3.51,
    'sulphates': 0.56,
    'alcohol': 9.4,
    'type': 'red' # Assuming 'type' is a feature
}, index=[0])

# 신규 데이터를 h2o 프레임으로 전환
new_data_h2o = h2o.H2OFrame(new_data_pandas)

# 6. 저장된 모델 로딩한 후 예측
saved_model = h2o.load_model(saved_model_path)
new_prediction = saved_model.predict(new_data_h2o)
print(f"\nPrediction for new data: \n {new_prediction}")

```

```
------------------------------------------------------------ 1. 데이터 로드
Parse progress: |(done) 100%
------------------------------------------------------------ 2. AutoML 실행
AutoML progress: (done) 100%
------------------------------------------------------------ 3. 결과 확인
model_id                                                    rmse       mse       mae      rmsle    mean_residual_deviance
StackedEnsemble_AllModels_1_AutoML_2_20250923_75639     0.614264  0.377321  0.438054  0.0932262                  0.377321
StackedEnsemble_BestOfFamily_1_AutoML_2_20250923_75639  0.614769  0.377941  0.438999  0.0932921                  0.377941
DRF_1_AutoML_2_20250923_75639                           0.619096  0.38328   0.448407  0.0940987                  0.38328
XGBoost_2_AutoML_2_20250923_75639                       0.672204  0.451858  0.489251  0.10155                    0.451858
GBM_1_AutoML_2_20250923_75639                           0.673562  0.453685  0.51817   0.10142                    0.453685
XGBoost_1_AutoML_2_20250923_75639                       0.676122  0.457141  0.489125  0.102293                   0.457141
GLM_1_AutoML_2_20250923_75639                           0.735082  0.540346  0.569586  0.11016                    0.540346
[7 rows x 6 columns]

stackedensemble prediction progress: |(done) 100%
predict
  5.88019
  5.74828
  5.22899
  5.68997
  6.22933
  7.40271
  4.63972
  5.6751
  5.67799
  5.39368
[10 rows x 1 column]

------------------------------------------------------------ 4. 모델 저장
   모델 저장 완료: /content/my_best_model/StackedEnsemble_AllModels_1_AutoML_2_20250923_75639
------------------------------------------------------------ 5. 신규 데이터 생성
Parse progress: | (done) 100%
------------------------------------------------------------ 6. 저장된 모델 로딩한 후 예측
stackedensemble prediction progress: | (done) 100%

Prediction for new data: 
  predict
    4.988
```

### 소스 코드 설명

```python
# 매우 간단한 버전
import h2o
from h2o.automl import H2OAutoML
h2o.init()
```

  * **H2O 초기화**: H2O 라이브러리를 가져오고 `h2o.init()` 명령으로 H2O 클러스터를 시작합니다. 이는 모델 학습을 위한 환경을 준비하는 단계입니다.


```python
# 1. 데이터 로드
df = h2o.import_file("...")
train, test = df.split_frame([0.8])
```

  * **데이터 준비**: 공개 데이터셋(와인 품질)을 불러와 **훈련 데이터**와 **테스트 데이터**로 나눕니다. 훈련 데이터는 모델을 학습시키는 데 사용되고, 테스트 데이터는 학습된 모델의 성능을 평가하는 데 사용됩니다.

<!-- end list -->

```python
# 2. AutoML 실행
aml = H2OAutoML(max_models=5, max_runtime_secs=120)  
aml.train(y="quality", training_frame=train)
```

  * **모델 자동 훈련**: `H2OAutoML` 객체를 생성하고 `train` 함수를 호출하여 모델 학습을 시작합니다. `max_models`는 최대 5개의 모델을, `max_runtime_secs`는 최대 120초 동안 훈련하도록 설정합니다. H2O는 이 설정에 맞춰 **다양한 머신러닝 모델(예: XGBoost, GBM, Random Forest)을 자동으로 훈련**하고 최적의 모델을 찾습니다.

<!-- end list -->

```python
# 3. 결과 확인
print(aml.leaderboard)
predictions = aml.leader.predict(test)
```

  * **최고 모델 선택 및 예측**: `aml.leaderboard`를 통해 훈련된 모델들의 순위를 확인하고, 가장 성능이 좋은 **'리더(leader)' 모델**을 선택합니다. 이후 이 리더 모델을 사용하여 테스트 데이터에 대한 예측을 수행합니다.

<!-- end list -->

```python
# 4. 모델 저장
saved_model_path = h2o.save_model(aml.leader, ...)
```

  * **모델 저장**: 훈련이 완료된 최고의 모델을 파일로 저장합니다. 이는 모델을 **나중에 다시 사용**하거나 **다른 시스템에 배포**하는 데 필요합니다.

<!-- end list -->

```python
# 5. 신규 데이터 생성
new_data_h2o = h2o.H2OFrame(...)
```

  * **신규 데이터 준비**: 예측에 사용할 새로운 데이터를 만듭니다. 이 데이터는 학습에 사용되지 않은 미지의 데이터입니다.

<!-- end list -->

```python
# 6. 저장된 모델 로딩한 후 예측
saved_model = h2o.load_model(saved_model_path)
new_prediction = saved_model.predict(new_data_h2o)
```
  * **모델 재사용**: 4단계에서 저장한 모델 파일을 불러와 새로운 데이터에 대한 예측을 수행합니다. 이는 모델이 **실제 서비스 환경**에서 어떻게 활용되는지를 보여줍니다.

**H2O의 실질적 기여**
- H2O AutoML은 사용자가 직접 해야 할 작업(데이터 전처리, 모델 선택, 하이퍼파라미터 튜닝, 성능 평가)을 대부분 자동화합니다. 
    - Wine 예제에서 H2O가 한 일을 요약하면:
        - **복잡한 전처리 자동화**: 결측값과 범주형 데이터를 사람이 신경 쓰지 않아도 처리.
        - **모델 탐색**: 수십 개의 모델과 설정을 시도해 최적의 조합을 찾음.
        - **시간 절약**: 사용자가 코드를 최소화하면서도 고성능 모델을 얻을 수 있게 함.
        - **결과 제공**: 성능 순위표를 통해 어떤 모델이 좋은지 직관적으로 보여줌.
