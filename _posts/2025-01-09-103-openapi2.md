---
title: 1차시 3(빅데이터 분석):Open API(실습 예제)
layout: single
classes: wide
categories:
  - Open API
toc: true # 이 포스트에서 목차를 활성화
toc_sticky: true # 목차를 고정할지 여부 (선택 사항)
---

## 1. 공공데이터포털 (data.go.kr)에서 약국 정보 받아오기
*   openapi를 이용해서 관련 데이터 내려받기(xml)

```python

import requests
from bs4 import BeautifulSoup

api_key = "YOUR_API_KEY"
url = 'http://apis.data.go.kr/B552657/ErmctInsttInfoInqireService/getParmacyListInfoInqire'
params ={'serviceKey' : api_key, 'Q0' : '서울특별시', 'Q1' : '강남구', 'QT' : '1', 'QN' : '삼성약국', 'ORD' : 'NAME', 'pageNo' : '1', 'numOfRows' : '10' }

response = requests.get(url, params=params)
```

*   내려받은 데이터에서 원하는 정보 발췌하기

```python
# XML 문자열 (이전 셀에서 response.content.decode('utf-8')로 얻은 값)
xml_string = response.content.decode('utf-8')

# BeautifulSoup으로 XML 파싱
# XML 파서 명시: 'lxml-xml'이 가장 권장됩니다.
soup = BeautifulSoup(xml_string, 'lxml-xml')  

# XML 구조를 보기 좋게 출력
# print(soup.prettify()[:500])

# 예시: 첫 번째 item 태그 찾기
first_item = soup.find('item')

# 첫 번째 item 태그의 하위 요소들 출력
if first_item:
    print("첫 번째 item:")
    for child in first_item.children:
        if child.name: # 태그인 경우에만 출력
            print(f"  {child.name}: {child.text}")
else:
    print("item 태그를 찾을 수 없습니다.")

# 예시: 모든 dutyName 태그 찾기
all_duty_names = soup.find_all('dutyName')

# 모든 dutyName 태그의 텍스트 출력
print("\n모든 약국 이름:")
for name_tag in all_duty_names:
    print(name_tag.text)
```

```python 
결과 값:

첫 번째 item:
  dutyAddr: 서울특별시 강남구 일원로 53 (일원동) 
  dutyMapimg: 소림빌딩 1층
  dutyName: E-삼성약국
  dutyTel1: 02-3412-1254
  dutyTime1c: 1900
  dutyTime1s: 0900
  dutyTime2c: 1900
  dutyTime2s: 0900
  dutyTime3c: 1900
  dutyTime3s: 0900
  dutyTime4c: 1900
  dutyTime4s: 0900
  dutyTime5c: 1900
  dutyTime5s: 0900
  dutyTime6c: 1300
  dutyTime6s: 0900
  hpid: C1104799
  postCdn1: 063
  postCdn2: 43 
  rnum: 1
  wgs84Lat: 37.4892626357407
  wgs84Lon: 127.081809638604

모든 약국 이름:
E-삼성약국
무지개삼성약국
삼성약국
이삼성약국
```

## 2. 공공데이터포털에서 한국환경공단_에어코리아_대기오염정보 받기
- 한국환경공단에서 제공하는 api 기술 문서가 있으니 자세한 내용은 참조할 것.
- 미세먼지(PM10), 초미세먼지(PM2.5), 오존(O3)의 농도에 따른 통보

```python
import requests
import json

# 1. API 정보 설정
# 발급받은 API 키를 여기에 입력하세요.
api_key = "YOUR_API_KEY"

# API 요청 URL
url = "http://apis.data.go.kr/B552584/ArpltnInforInqireSvc/getMinuDustFrcstDspth"

# 2. 요청 변수(Parameters) 설정
# 필요한 요청 변수들을 딕셔너리 형태로 정의합니다.
params = {
    "serviceKey": api_key,  # API 키
    "returnType": "json",  # 응답 데이터 형식 (JSON)
    "numOfRows": "100",  # 한 페이지 결과 수
    "searchDate": "2025-08-19",
    "pageNo":"1",
}

try:
    # 3. HTTP GET 요청 보내기
    response = requests.get(url, params=params)

    # 4. 응답 확인
    if response.status_code == 200:
        # 응답 본문을 JSON 형태로 변환
        # print(response.text)
        data = response.json()

        # 5. 데이터 파싱 및 출력
        # 필요한 정보(예: 측정소 이름, 미세먼지 농도)를 추출하여 출력합니다.
        items = data["response"]["body"]["items"]
        
        if items:
            print("=== 대기질(미세먼지/오존) 예보통보 조회 ===")
            for item in items[:5]:
                print(f"통보시간: {item['dataTime']}")
                print(f"통보코드: {item['informCode']}")
                print(f"예보개황: {item['informOverall']}")
                print(f"발생원인: {item['informCause']}")
                print("-" * 30)
        else:
            print("데이터가 없습니다.")
    else:
        print(f"API 요청 실패: 상태 코드 {response.status_code}")
        print(f"에러 메시지: {response.text}")

except requests.exceptions.RequestException as e:
    print(f"네트워크 오류 발생: {e}")
```


```
결과 값:
=== 대기질(미세먼지/오존) 예보통보 조회 ===
통보시간: 2025-08-19 11시 발표
통보코드: PM10
예보개황: ○ [미세먼지] 전 권역이 '좋음'∼'보통'으로 예상됩니다.
발생원인: ○ [미세먼지] 원활한 대기 확산으로 대기질이 대체로 청정할 것으로 예상됩니다.
------------------------------
통보시간: 2025-08-19 11시 발표
통보코드: PM10
예보개황: ○ [미세먼지] 전 권역이 '좋음'으로 예상됩니다.
발생원인: ○ [미세먼지] 원활한 대기 확산으로 대기질이 청정할 것으로 예상됩니다.
------------------------------
통보시간: 2025-08-19 11시 발표
통보코드: PM25
예보개황: ○ [미세먼지] 전 권역이 '좋음'∼'보통'으로 예상됩니다.
발생원인: ○ [미세먼지] 원활한 대기 확산으로 대기질이 대체로 청정할 것으로 예상됩니다.
------------------------------
통보시간: 2025-08-19 11시 발표
통보코드: PM25
예보개황: ○ [미세먼지] 전 권역이 '좋음'으로 예상됩니다.
발생원인: ○ [미세먼지] 원활한 대기 확산으로 대기질이 청정할 것으로 예상됩니다.
------------------------------
통보시간: 2025-08-19 11시 발표
통보코드: O3
예보개황: ○ [오존] 전 권역이 '보통'으로 예상됩니다.
발생원인: ○ [오존] 고농도 오존 생성에 유리한 조건이 형성되지 않아 농도가 높지 않을 것으로 예상됩니다.
------------------------------
```